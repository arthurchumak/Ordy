!function(t){var e=function(i,s,n){n&&(n.stopPropagation(),n.preventDefault()),this.$element=t(i),this.$newElement=null,this.button=null,this.options=t.extend({},t.fn.selectpicker.defaults,this.$element.data(),"object"==typeof s&&s),null==this.options.title&&(this.options.title=this.$element.attr("title")),this.val=e.prototype.val,this.render=e.prototype.render,this.init()};e.prototype={constructor:e,init:function(){var e=this;this.$element.hide(),this.multiple=this.$element.prop("multiple");var i=void 0!==this.$element.attr("class")?this.$element.attr("class").split(/\s+/):"",s=this.$element.attr("id");this.$element.after(this.createView()),this.$newElement=this.$element.next(".select");var n=this.$newElement,a=this.$newElement.find(".dropdown-menu"),o=this.$newElement.find(".dropdown-arrow"),r=(a.find("li > a"),n.addClass("open").find(".dropdown-menu li > a").outerHeight());n.removeClass("open");var c=a.find("li .divider").outerHeight(!0),l=this.$newElement.offset().top,d=0,h=this.$newElement.outerHeight();this.button=this.$newElement.find("> button"),void 0!==s&&(this.button.attr("id",s),t('label[for="'+s+'"]').click(function(){n.find("button#"+s).focus()}));for(var f=0;f<i.length;f++)"selectpicker"!=i[f]&&this.$newElement.addClass(i[f]);this.multiple&&this.$newElement.addClass("select-multiple"),this.button.addClass(this.options.style),a.addClass(this.options.menuStyle),o.addClass(function(){return e.options.menuStyle?e.options.menuStyle.replace("dropdown-","dropdown-arrow-"):void 0}),this.checkDisabled(),this.checkTabIndex(),this.clickListener();var p=parseInt(a.css("padding-top"))+parseInt(a.css("padding-bottom"))+parseInt(a.css("border-top-width"))+parseInt(a.css("border-bottom-width"));if("auto"==this.options.size){var u=debounce(function(){var e=l-t(window).scrollTop(),i=t(window).innerHeight(),s=p+parseInt(a.css("margin-top"))+parseInt(a.css("margin-bottom"))+2,o=i-e-h-s;d=o,n.hasClass("dropup")&&(d=e-s),300>d||(d=300),a.css({"max-height":d+"px","overflow-y":"auto","min-height":3*r+"px"})},50);t(window).on("scroll",u),t(window).on("resize",u),window.MutationObserver?new MutationObserver(u).observe(this.$element.get(0),{childList:!0}):this.$element.bind("DOMNodeInserted",u)}else if(this.options.size&&"auto"!=this.options.size&&a.find("li").length>this.options.size){var g=a.find("li > *").filter(":not(.divider)").slice(0,this.options.size).last().parent().index(),m=a.find("li").slice(0,g+1).find(".divider").length;d=r*this.options.size+m*c+p,a.css({"max-height":d+"px","overflow-y":"scroll"})}window.MutationObserver?new MutationObserver(t.proxy(this.reloadLi,this)).observe(this.$element.get(0),{childList:!0}):this.$element.bind("DOMNodeInserted",t.proxy(this.reloadLi,this)),this.render()},createDropdown:function(){var e="<div class='btn-group select'><button class='btn dropdown-toggle clearfix' data-toggle='dropdown'><span class='filter-option'></span>&nbsp;<span class='caret'></span></button><span class='dropdown-arrow'></span><ul class='dropdown-menu' role='menu'></ul></div>";return t(e)},createView:function(){var t=this.createDropdown(),e=this.createLi();return t.find("ul").append(e),t},reloadLi:function(){this.destroyLi(),$li=this.createLi(),this.$newElement.find("ul").append($li),this.render()},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var e=this,i=[],s=[],n="";if(this.$element.find("option").each(function(){i.push(t(this).text())}),this.$element.find("option").each(function(){var i=void 0!==t(this).attr("class")?t(this).attr("class"):"",n=t(this).text(),a=void 0!==t(this).data("subtext")?'<small class="muted">'+t(this).data("subtext")+"</small>":"";if(n+=a,t(this).parent().is("optgroup")&&1!=t(this).data("divider"))if(0==t(this).index()){var o=t(this).parent().attr("label"),r=void 0!==t(this).parent().data("subtext")?'<small class="muted">'+t(this).parent().data("subtext")+"</small>":"";o+=r,s.push(0!=t(this)[0].index?'<div class="divider"></div><dt>'+o+"</dt>"+e.createA(n,"opt "+i):"<dt>"+o+"</dt>"+e.createA(n,"opt "+i))}else s.push(e.createA(n,"opt "+i));else s.push(1==t(this).data("divider")?'<div class="divider"></div>':1==t(this).data("hidden")?"":e.createA(n,i))}),i.length>0)for(var a=0;a<i.length;a++){{this.$element.find("option").eq(a)}n+="<li rel="+a+">"+s[a]+"</li>"}return 0!=this.$element.find("option:selected").length||e.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),t(n)},createA:function(t,e){return'<a tabindex="-1" href="#" class="'+e+'"><span class="">'+t+"</span></a>"},render:function(){var e=this;if("auto"==this.options.width){var i=this.$newElement.find(".dropdown-menu").css("width");this.$newElement.css("width",i)}else this.options.width&&"auto"!=this.options.width&&this.$newElement.css("width",this.options.width);this.$element.find("option").each(function(i){e.setDisabled(i,t(this).is(":disabled")||t(this).parent().is(":disabled")),e.setSelected(i,t(this).is(":selected"))});var s=this.$element.find("option:selected").map(function(){return void 0!=t(this).attr("title")?t(this).attr("title"):t(this).text()}).toArray(),n=s.join(", ");if(e.multiple&&e.options.selectedTextFormat.indexOf("count")>-1){var a=e.options.selectedTextFormat.split(">");(a.length>1&&s.length>a[1]||1==a.length&&s.length>=2)&&(n=s.length+" of "+this.$element.find("option").length+" selected")}n||(n=void 0!=e.options.title?e.options.title:e.options.noneSelectedText),this.$element.next(".select").find(".filter-option").html(n)},setSelected:function(t,e){e?this.$newElement.find("li").eq(t).addClass("selected"):this.$newElement.find("li").eq(t).removeClass("selected")},setDisabled:function(t,e){e?this.$newElement.find("li").eq(t).addClass("disabled"):this.$newElement.find("li").eq(t).removeClass("disabled")},checkDisabled:function(){this.$element.is(":disabled")&&(this.button.addClass("disabled"),this.button.click(function(t){t.preventDefault()}))},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var t=this.$element.attr("tabindex");this.button.attr("tabindex",t)}},clickListener:function(){var e=this;t("body").on("touchstart.dropdown",".dropdown-menu",function(t){t.stopPropagation()}),this.$newElement.on("click","li a",function(i){var s=t(this).parent().index(),n=t(this).parent(),a=n.parents(".select");if(e.multiple&&i.stopPropagation(),i.preventDefault(),a.prev("select").not(":disabled")&&!t(this).parent().hasClass("disabled")){if(e.multiple){var o=a.prev("select").find("option").eq(s).prop("selected");o?a.prev("select").find("option").eq(s).removeAttr("selected"):a.prev("select").find("option").eq(s).prop("selected",!0).attr("selected","selected")}else a.prev("select").find("option").removeAttr("selected"),a.prev("select").find("option").eq(s).prop("selected",!0).attr("selected","selected");a.find(".filter-option").html(n.text()),a.find("button").focus(),a.prev("select").trigger("change")}}),this.$newElement.on("click","li.disabled a, li dt, li .divider",function(e){e.preventDefault(),e.stopPropagation(),$select=t(this).parent().parents(".select"),$select.find("button").focus()}),this.$element.on("change",function(){e.render()})},val:function(t){return void 0!=t?(this.$element.val(t),this.$element.trigger("change"),this.$element):this.$element.val()}},t.fn.selectpicker=function(i,s){var n,a=arguments,o=this.each(function(){var o=t(this),r=o.data("selectpicker"),c="object"==typeof i&&i;if(r)for(var l in i)r[l]=i[l];else o.data("selectpicker",r=new e(this,c,s));"string"==typeof i&&(property=i,r[property]instanceof Function?([].shift.apply(a),n=r[property].apply(r,a)):n=r[property])});return void 0!=n?n:o},t.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",width:null,menuStyle:null,toggleSize:null}}(window.jQuery);